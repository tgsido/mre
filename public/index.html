<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>MRE</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js" defer></script>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous" defer>
    <link rel="stylesheet" href="/css/style.css"/>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous" defer></script>


    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCPXcyJpsmPm8RHJhmBDRd2o86_P26O8y4&libraries=places&language=en"></script>
    <script src="/js/app.js" defer></script>
    <script src="/js/script.js" defer></script>

    </script>
  </head>
  <body>

    <!-- Navigation Bar -->
    <nav id="navigation-bar" class="navbar navbar-default navbar-static-top inactive">
            <div class="container-fluid">
              <!-- Brand and toggle get grouped for better mobile display -->
              <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a id="brand" class="navbar-brand" href="#">MRE</a>
              </div>

              <!-- Collect the nav links, forms, and other content for toggling -->
              <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                  <li class="nav-item">
                    <a class="nav-link active" id="your-meetings-link" href="#">Your meetings</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="signout-button" style="display: none;" href="#">Sign out</a>
                  </li>

                  <!--
                  <li class="dropdown">
                    <div id="user-profile-info" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                        <span id="name-link"></span>
                        <span class="caret"></span>
                    </div>
                    <ul class="dropdown-menu">
                       <li><a href="#" id="view-past-shuffles">View your past shuffles</a></li>
                       <li role="separator" class="divider"></li>
                       <li><a href="#" id="google-logout">Sign out</a></li>
                    </ul>
                  </li> -->
                </ul>
              </div><!-- /.navbar-collapse -->
            </div><!-- /.container-fluid -->
</nav>

    <!-- Authorization -->
    <div id="auth-screen">
      <div id="auth-container">
          <h1>MRE</h1>
          <button id="authorize-button" style="display: none;">Sign in</button>
      </div>
    </div>


  <!-- Home Screen -->
    <div id="home-screen" class="inactive">
      <!-- Main jumbotron for a primary marketing message or call to action -->
        <div class="jumbotron">
          <div class="container">
            <h1>Welcome!</h1>
            <p>This is MRE - your all-in-one tool to schedule,
              join, and view meetings taking place around the
              world!
            </p>
            <button id="go-button" class="btn btn-success" type="button"
            aria-haspopup="true" aria-expanded="true">GO</button>
          </div>
        </div>

        <div id="home-screen-info" class="container">
        <!-- Example row of columns -->
        <div class="row">
          <div class="col-md-4">
            <h2>Schedule</h2>
            <p>Set up meetings today, tomorrow, or whenever most conveinent
              to connect with coworkers, facilitate meetings remotely from anywhere in the world,
              lead learning sessions to aid in knowledge transfer. The possibilities are limitless!
             </p>
            <!--<p><a class="btn btn-secondary" href="#" role="button">Schedule meeting &raquo;</a></p>-->
          </div>
          <div class="col-md-4">
            <h2>Join</h2>
            <p>Participate in meetings from your office, couch, or some remote beach of your choice.
              As long as you have a wifi connection, you can stay connected with peers, colleagues, and loved ones. </p>
            <!--<p><a class="btn btn-secondary" href="#" role="button">Schedule meeting &raquo;</a></p>-->
         </div>
          <div class="col-md-4">
            <h2>View</h2>
            <p>View and possibly join public meetings around you.
              Learn how to design brilliant UIs from designers in the valley or learn how to basecamp
              from trekers near the alps. The choice is yours, so take a look!
            </p>
            <!--<p><a class="btn btn-secondary" href="#" role="button">Schedule meeting &raquo;</a></p>-->
          </div>
        </div>

        <hr>

      </div> <!-- /container -->

    </div>



    <!-- Event Screen -->
      <div id="event-screen" class="inactive">
        <!--
        <ul class="nav nav-pills">
            <li class="nav-item">
              <a class="nav-link active" href="#content">Your meetings</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Meetings around you</a>
            </li>
        </ul> -->

            <div id="new-meeting" class="container inactive">

              <button id="close-new-meeting" type="button" class="close btn-lg" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
              <h1>New Meeting:</h1>
              <form>
                  <div class="form-group">
                    <label >Meeting Title</label>
                    <input id="meeting-title" class="form-control" placeholder="Meeting Title (i.e How to TCON 101)">
                  </div>
                  <div class="form-group">
                    <label>Location</label>
                    <input id="autocomplete" type="text" class="form-control" />
                  </div>
                  <div class="form-group">
                    <label for="example-datetime-local-input" >Start time</label>
                    <input id="meeting-start-time" class="form-control" type="datetime-local" value="2011-08-19T13:45:00" id="example-datetime-local-input">
                  </div>
                  <div class="form-group">
                    <label for="example-datetime-local-input" >End time</label>
                    <input id="meeting-end-time" class="form-control" type="datetime-local" value="2011-08-19T13:45:00" id="example-datetime-local-input">
                  </div>
                  <div class="form-group">
                    <label for="exampleSelect1">Time Zone</label>
                    <select id="meeting-timezone" class="form-control" id="exampleSelect1">
                      <option>Pacific</option>
                      <option>Mountain</option>
                      <option>Central</option>
                      <option>Eastern</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="exampleInputEmail1">Attendee Email</label>
                    <input id="meeting-attendee" type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email">
                    <!--<small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small> -->
                  </div>
                  <div class="form-group">
                    <label for="exampleTextarea">Meeting Description</label>
                    <textarea id="meeting-description" class="form-control" id="exampleTextarea"
                    placeholder="Today, we'll be going over the basics of getting a tcon number, how to lead a meeting, and general tcon etiquette." rows="3"></textarea>
                  </div>
                  <div class="form-group">
                    <label for="exampleTextarea">Meeting Tag</label>
                    <input id="meeting-tag" class="form-control" placeholder="GEHC">
                  </div>

                  <button id="new-button-submit" class="btn btn-primary">Submit</button>
              </form>
            </div>


          <div class="container">

            <div class="row">
              <div class="col-sm-6 home">
                <h2>Schedule meetings</h2>
                <button id="insert-event-button" type="button" class="btn btn-primary">Schedule meeting</button>
                <p> To get started with creating a meeting, click 'Schedule meeting' and fill out the related fields.</p>
              </div>
              <div class="col-sm-6 home">
                <h2>Find and join meetings</h2>
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalLong">Find meetings</button>
                <p>To find meetings around you, click 'Find meetings' and type in a keyword related to the meeting! </p>
             </div>
            </div>






            <!-- Modal -->
            <div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    Search
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <form id="mre-input-form">
                      <input id="event-query-input" type="text" placeholder="Type meeting keyword here... i.e (GE)"/>
                      <button id="mre-search-button" type="submit"> Search </button>
                    </form>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  </div>
                </div>
              </div>
            </div>



          </div>


          <div id="newsfeed" class="container">
            <pre id="content" class="inactive"></pre>
            <div id="search-results" class="container inactive">
              <div id="meetings" class="container">
                <!-- populated with search results -->
              </div>
            </div>
          </div>
      </div>



    <script type="text/javascript">
      // Client ID and API key from the Developer Console
      var CLIENT_ID = '57138272784-bulo8okotk3vnkktd6glk471np8jsqeb.apps.googleusercontent.com';


      // Array of API discovery doc URLs for APIs used by the quickstart
      var DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"];

      // Authorization scopes required by the API; multiple scopes can be
      // included, separated by spaces.
      var SCOPES = "https://www.googleapis.com/auth/calendar";

      var authorizeButton = document.getElementById('authorize-button');
      var signoutButton = document.getElementById('signout-button');

      /**
       *  On load, called to load the auth2 library and API client library.
       */
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }

      /**
       *  Initializes the API client library and sets up sign-in state
       *  listeners.
       */
      function initClient() {
        gapi.client.init({
          discoveryDocs: DISCOVERY_DOCS,
          clientId: CLIENT_ID,
          scope: SCOPES
        }).then(function () {
          // Listen for sign-in state changes.
          gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

          // Handle the initial sign-in state.
          updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
          authorizeButton.onclick = handleAuthClick;
          signoutButton.onclick = handleSignoutClick;
          //insertEventButton.onclick = onInsertEventClicked;
        });
      }

      /**
       *  Called when the signed in status changes, to update the UI
       *  appropriately. After a sign-in, the API is called.
       */
      function updateSigninStatus(isSignedIn) {
        if (isSignedIn) {
          authorizeButton.style.display = 'none';
          signoutButton.style.display = 'block';
          listUpcomingEvents();
          const eventInfo = {};
          eventInfo.gapi = gapi;
          document.dispatchEvent(new CustomEvent('user-loggedin', { detail: eventInfo }));

        } else {
          authorizeButton.style.display = 'block';
          signoutButton.style.display = 'none';
        }
      }

      /**
       *  Sign in the user upon button click.
       */
      function handleAuthClick(event) {
        gapi.auth2.getAuthInstance().signIn();
      }

      /**
       *  Sign out the user upon button click.
       */
      function handleSignoutClick(event) {
        gapi.auth2.getAuthInstance().signOut();
        const eventInfo = {};
        document.dispatchEvent(new CustomEvent('user-loggedout', { detail: eventInfo }));
      }

      /**
       * Append a pre element to the body containing the given message
       * as its text node. Used to display the results of the API call.
       *
       * @param {string} message Text to be placed in pre element.
       */
      function appendPre(message) {
        var pre = document.getElementById('content');
        var textContent = document.createTextNode(message + '\n');
        pre.appendChild(textContent);
      }

      /**
       * Print the summary and start datetime/date of the next ten events in
       * the authorized user's calendar. If no events are found an
       * appropriate message is printed.
       */
      function listUpcomingEvents() {
        gapi.client.calendar.events.list({
          'calendarId': 'primary',
          'timeMin': (new Date()).toISOString(),
          'showDeleted': false,
          'singleEvents': true,
          'maxResults': 20,
          'orderBy': 'startTime'
        }).then(function(response) {
          var events = response.result.items;
          appendPre('Upcoming events:');

            // clear container
            var pre = document.getElementById('content');
            pre.innerHTML = '';

          if (events.length > 0) {
            for (i = 0; i < events.length; i++) {
              var event = events[i];
              var when = event.start.dateTime;
              if (!when) {
                when = event.start.date;
              }

              let newEventSection = document.createElement("section");
              let meetingName = document.createElement("h1");
              let meetingLocation = document.createElement('p');
              let meetingTiming = document.createElement('p');
              var options = {
               weekday: "long", year: "numeric", month: "short",
               day: "numeric", hour: "2-digit", minute: "2-digit"
              };

             let startDate = new Date(event.start.dateTime);
             let endDate = new Date(event.end.dateTime);

              meetingName.textContent = event.summary;
              meetingLocation.textContent = 'Location: ' + event.location;
              meetingTiming.textContent = 'Time: ' + startDate.toLocaleTimeString("en-us", options) + ' - ' + endDate.toLocaleTimeString("en-us", options);

              newEventSection.appendChild(meetingName);
              newEventSection.appendChild(meetingTiming);
              newEventSection.appendChild(meetingLocation);

              pre.appendChild(newEventSection);

            }
          } else {
            appendPre('No upcoming events found.');
          }
        });
      }
    </script>





<!--
    <script>
      var input = document.getElementById('autocomplete');
      var autocomplete = new google.maps.places.Autocomplete(input);
    </script> -->

    <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>




  </body>
</html>
